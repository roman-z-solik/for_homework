# Виджет для банка

Это виджет, который показывает несколько 
последних успешных банковских операций клиента.
Проект создан в учебных целях. В разработке.

## Содержание

## Технологии
[Python] (https://www.python.org/)
![Poetry](https://img.shields.io/badge/Poetry-%233B82F6.svg?style=for-the-badge&logo=poetry&logoColor=0B3D8D)

## Использование
Открыть проект в PyCharm.  
**masks.py** содержит 2 функции:

`get_mask_card_number`  
Функция принимает на вход номер карты и возвращает ее маску. Номер карты замаскирован и отображается в формате XXXX XX** **** XXXX, где X — это цифра номера. То есть видны первые 6 цифр и последние 4 цифры, остальные символы отображаются звездочками, номер разбит по блокам по 4 цифры, разделенным пробелами. Пример работы функции:  
7000792289606361        # входной аргумент  
7000 79** **** 6361     # выход функции  

`get_mask_account`  
Функция принимает на вход номер счета и возвращает его маску. Номер счета замаскирован и отображается в формате **XXXX, где X — это цифра номера. То есть видны только последние 4 цифры номера, а перед ними — две звездочки. Пример работы функции:  
73654108430135874305    # входной аргумент  
**4305                  # выход функции  

**processing.py** содержит 2 функции:

`filter_by_state`  
Принимает список словарей и опционально значение для ключа state (по умолчанию 'EXECUTED'). Функция возвращает новый список словарей, содержащий только те словари, у которых ключ state соответствует указанному значению. Примеры работы функции:  
#Выход функции со статусом по умолчанию 'EXECUTED'  
[{'id': 41428829, 'state': 'EXECUTED', 'date': '2019-07-03T18:35:29.512364'}, {'id': 939719570, 'state': 'EXECUTED', 'date': '2018-06-30T02:08:58.425572'}]  
#Выход функции, если вторым аргументов передано 'CANCELED'  
[{'id': 594226727, 'state': 'CANCELED', 'date': '2018-09-12T21:27:25.241689'}  

`sort_by_date`  
Принимает список словарей и необязательный параметр, задающий порядок сортировки (по умолчанию — убывание). Функция должна возвращать новый список, отсортированный по дате. Примеры работы функции:

#Выход функции (сортировка по убыванию, т. е. сначала самые последние операции)
[{'id': 41428829, 'state': 'EXECUTED', 'date': '2019-07-03T18:35:29.512364'}, {'id': 615064591, 'state': 'CANCELED', 'date': '2018-10-14T08:21:33.419441'}, {'id': 594226727, 'state': 'CANCELED', 'date': '2018-09-12T21:27:25.241689'}, {'id': 939719570, 'state': 'EXECUTED', 'date': '2018-06-30T02:08:58.425572'}]

*widget.py* содержит 2 функции:

`mask_account_card`  
Функция должна принимать один аргумент — строку, содержащую тип и номер карты или счета.
Аргументом может быть строка типа  
Visa Platinum 7000792289606361,  
Maestro 7000792289606361,  
Счет 73654108430135874305  
Возвращает строку с замаскированным номером. Для карт и счетов используются разные типы маскировки. 
Использует функции маскировки из модуля masks. Примеры работы функции:  
#Пример для карты:  
Visa Platinum 7000792289606361      # входной аргумент  
Visa Platinum 7000 79** **** 6361   # выход функции  
#Пример для счета:  
Счет 73654108430135874305           # входной аргумент  
Счет **4305                         # выход функции  

`get_date`  
Принимает на вход строку с датой в формате   
"2024-03-11T02:26:18.671407"
и возвращает строку с датой в формате   
"ДД.ММ.ГГГГ" ("11.03.2024").

**generators.py** содержит 1 функцию и 2 генератора:  

`filter_by_currency`
Принимает на вход список словарей, представляющих транзакции.
Функция должна возвращать итератор, который поочередно выдает транзакции, где валюта операции
соответствует заданной (например, USD).  
#Пример вывода функции:
>>> {
          "id": 939719570,  
          "state": "EXECUTED",  
          "date": "2018-06-30T02:08:58.425572",  
          "operationAmount": {  
              "amount": "9824.07",  
              "currency": {  
                  "name": "USD",  
                  "code": "USD"  
              }  
          },  
          "description": "Перевод организации",  
          "from": "Счет 75106830613657916952",  
          "to": "Счет 11776614605963066702"  
      }  
      {  
              "id": 142264268,  
              "state": "EXECUTED",  
              "date": "2019-04-04T23:20:05.206878",  
              "operationAmount": {  
                  "amount": "79114.93",  
                  "currency": {  
                      "name": "USD",  
                      "code": "USD"  
                  }  
              },  
              "description": "Перевод со счета на счет",  
              "from": "Счет 19708645243227258542",  
              "to": "Счет 75651667383060284188"  
       }    


`transaction_descriptions`
Генератор, который принимает список словарей 
с транзакциями и возвращает описание каждой операции по очереди.
#Пример вывода:
>>> Перевод организации  
    Перевод со счета на счет  
    Перевод со счета на счет  
    Перевод с карты на карту  
    Перевод организации

`card_number_generator`
Генератор, который выдает
номера банковских карт в формате XXXX XXXX XXXX XXXX, где
X — цифра номера карты. Генератор может сгенерировать номера карт
в заданном диапазоне от 0000 0000 0000 0001 до 9999 9999 9999 9999
#Пример вывода:
>>> 0000 0000 0000 0001  
    0000 0000 0000 0002  
    0000 0000 0000 0003  
    0000 0000 0000 0004  
    0000 0000 0000 0005  

**decorators.py** содержит 1 декоратор:  

`log`
Декоратор log принимает необязательный аргумент filename, 
который определяет имя файла, в который будут записываться логи.
Если filename не задан, то логи выводятся в консоль. Если вызов функции 
закончился ошибкой, записывается сообщение об ошибке и входные параметры функции.  
#Пример вывода:  
Ожидаемый вывод в лог-файл   
mylog.txt  
при успешном выполнении:  
my_function ok
Ожидаемый вывод при ошибке:
my_function error: тип ошибки. Inputs: (1, 2), {}
Где тип ошибки заменяется на текст ошибки.

## Информация о тестировании:

Для тестирования использовался фрейморк `pytest`.
Запуск тестов в терминале: команда `pytest`.
Приложение протестировано. Тесты пройдены успешно.
Отчет о выполнении тестов в формате HTML находится в папке [папка](htmlcov/index.html).

Папка `tests` содержит файлы для тестирования модулей:  
**test_masks.py**  
**test_processing.py**  
**test_widget.py**  
**test_generators.py**  
**test_decorators.py**


### Требования
Для установки и запуска проекта, необходимы:
[Python](https://www.python.org/)
[PyCharm](https://www.jetbrains.com/pycharm/)

## Команда проекта
[Roman Z](roman-z@inbox.ru)